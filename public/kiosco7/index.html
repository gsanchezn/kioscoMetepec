<!DOCTYPE html>
<html>

<head>
	<title>Kiosco Metepec</title>
	<meta charset="utf-8">
	<link rel="stylesheet" href="../styles.css">
	<link href="https://fonts.googleapis.com/css?family=Oswald:400,600|Poppins" rel="stylesheet">
	<!-- Bootstrap core CSS -->
	<link href="../css/bootstrap.min.css" rel="stylesheet">

	<!-- Custom styles for this template -->
	<link href="../css/owl.carousel.css" rel="stylesheet">
	<link href="../css/owl.theme.default.css" rel="stylesheet">
	<link href="../css/custom.css" rel="stylesheet">
	<link rel="stylesheet" href="../fonts/css/font-awesome.min.css">

	<link rel="stylesheet" href="../css/animate.css">
	
	<link rel="stylesheet" href="../css/ekko-lightbox.css">
</head>

<body>

	<nav class="navbar navbar-expand-md navbar-dark bg-dark mb-4">
		<div class="container-fluid">
			<a class="iframe-btn" href="/kiosco7" style="padding-right: 20px">
				<i class="fa fa-chevron-circle-left" aria-hidden="true" style="color: #ffffff"> regresar</i>
			</a>
			<a class="navbar-brand" href="#">
				<img class="img-fluid" src="../img/logos_metepec.png" style="max-height: 40px;">
			</a>
			<button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarCollapse" aria-controls="navbarCollapse"
			 aria-expanded="false" aria-label="Toggle navigation">
				<span class="navbar-toggler-icon"></span>
			</button>
			<div class="collapse navbar-collapse" id="navbarCollapse">
				<div class=" mt-2 mt-md-0 text-right ml-auto">
					<h5 class="text-white align-middle mb-0">Sistema Digital Multiservicios</h5>
				</div>
			</div>
		</div>
	</nav>
	<main role="main" class="iframe-content">
		<div class="">
			<iframe class="embed-responsive-item pagina-tramite" id="iframeContainer" src="" style="height: 85vh;width: 100vw;">
			</iframe>
		</div>
	</main>
	<main role="main" class="container-fluid main-tramites">
		<div class="row align-items-center" style="height: 85vh">
			<div class="col-9">
				<!-- ITEMS DE CIRCULOS -->
				<div class="row enter-items">

				</div>
			</div>
			<div class="col-3">
				<!-- PRIMER CAROUSEL -->
				<div id="owl-demo" class="owl-carousel owl-theme mb-2">

				</div>
				<!-- CAROUSEL DE NOTICIAS -->
				<div id="carouselExampleIndicators" class="carousel slide" data-ride="carousel">
					<ol class="carousel-indicators">
						
					</ol>
					<div class="carousel-inner">
					</div>
					<a class="carousel-control-prev" href="#carouselExampleIndicators" role="button" data-slide="prev">
						<span class="carousel-control-prev-icon" aria-hidden="true"></span>
						<span class="sr-only">Previous</span>
					</a>
					<a class="carousel-control-next" href="#carouselExampleIndicators" role="button" data-slide="next">
						<span class="carousel-control-next-icon" aria-hidden="true"></span>
						<span class="sr-only">Next</span>
					</a>
				</div>
			</div>
		</div>
	</main>


	<!-- Modales en pop up cuando se da click en algun elemento -->
	<div class="modal-items-circulo">

	</div>

	<!-- Modal animaciones -->
	<div class="modal fade modalAnimacion" id="modal-anim" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel"
	 aria-hidden="true">
		<div class="modal-dialog modal-dialog-centered" role="document">
			<div class="modal-content">

				<div class="modal-body">
					<img id="modalAnimacion-img" src="" class="img-fluid imagen-modal mx-auto d-block">
					<h3 id="dinamic-title" class="text-center pt-4"></h3>
				</div>

			</div>
		</div>
	</div>

	<!-- Modal animaciones slider -->
	<div class="modal fade modalAnimacionSlider" id="modalAnimacionSli" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel"
	 aria-hidden="true">
		<div class="modal-dialog modal-dialog-centered" role="document" style="max-width: 50%;">
			<div class="modal-content">

				<div class="modal-body">
					<div class="owl-carousel owl-theme">

					</div>
				</div>

			</div>
		</div>
	</div>

	<!-- Modal animaciones PROMOS -->
	<div class="modal fade modalesp" id="modalesp" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel"
	 aria-hidden="true">
		<div class="modal-dialog modal-dialog-centered" role="document" style="max-width: 100%;">
			<div class="modal-content">

				<div class="modal-body">
					<div id="carouselmodalesp" class="carousel slide" data-ride="carousel">
						<ol class="carousel-indicators">
							<li data-target="#carouselmodalesp" data-slide-to="0" class="active"></li>
							<li data-target="#carouselmodalesp" data-slide-to="1"></li>
							<li data-target="#carouselmodalesp" data-slide-to="2"></li>
						</ol>
						<div class="carousel-inner-esp">


						</div>
						<a class="carousel-control-prev" href="#carouselmodalesp" role="button" data-slide="prev">
							<span class="carousel-control-prev-icon" aria-hidden="true"></span>
							<span class="sr-only">Previous</span>
						</a>
						<a class="carousel-control-next" href="#carouselmodalesp" role="button" data-slide="next">
							<span class="carousel-control-next-icon" aria-hidden="true"></span>
							<span class="sr-only">Next</span>
						</a>
					</div>
				</div>

			</div>
		</div>
	</div>




	<script src="https://code.jquery.com/jquery-3.3.1.min.js"></script>
	<script>window.jQuery || document.write('<script src="js/jquery-slim.min.js"><\/script>')</script>
	<script src="../js/popper.min.js"></script>
	<script src="../js/bootstrap.min.js"></script>

	<script src="../js/owl.carousel.js"></script>

	<script src="../js/Chain.js"></script>
	<!-- <script type="text/javascript" src="../js/owlcarousel-json-load.js"></script> -->
	<script src="https://cdnjs.cloudflare.com/ajax/libs/ekko-lightbox/5.3.0/ekko-lightbox.js"></script>
	
	<script>
	$(document).on('click', '[data-toggle="lightbox"]', function(event) {
                event.preventDefault();
                $(this).ekkoLightbox();
            });
	</script>
	<script>
		$.getJSON("http://www.metepec.gob.mx/Kioscosdm/api.php?valor=eventos").done(function (data) {
			console.log(data);
			$.each(data, function (index, img) {
				$(".owl-carousel").append("<a href='" + img.imagen + "' data-toggle='lightbox'>" +
				"<img src='" + img.imagen + "'>" +
				"</a>" +
					"</div>");
			
				/* $('<h4>', { src: img.titulo }).appendTo(".owl-item"); */
				console.log(img.titulo);
				console.log(img.imagen);
			});

			$(".owl-carousel").owlCarousel({
				dots: false,
				items: 1,
				loop: true,
				margin: 0,
				nav: false,
				autoplay: true,
				autoplayTimeout: 4000,
			});
		});

		$.getJSON("http://www.metepec.gob.mx/Kioscosdm/api.php?valor=noticias").done(function (dataNoticias) {
			console.log(dataNoticias);
			$.each(dataNoticias, function (index, img) {

				$(".carousel-inner").append("<div class='carousel-item '>" +
						"<a href='" + img.imagen + "' data-toggle='lightbox' data-title='" + img.titulo + "'  data-footer='" + img.contenido + "'>" +
					"<img class='d-block w-100 h300' src='" + img.imagen + "' alt='Metepec'>" +
					"<div class='carousel-caption d-none d-md-block'>" +
					"<p>" + img.titulo + "</p>" +
					"</div>" +
					"</a>" +
					"</div>");

				$('.carousel-inner .carousel-item:first').addClass('active');


				console.log(img.titulo);
				console.log(img.imagen);
			});
		});

		$.getJSON("http://metepec.gob.mx/Kioscosdm/api.php?valor=espectaculares").done(function (dataEspectacular) {
			console.log(dataEspectacular);
			$.each(dataEspectacular, function (index, img) {
				$(".carousel-inner-esp").append("<div class='carousel-item '>" +
					"<img class='d-block w-100' src='" + img.imagen + "' alt='Metepec'>" +
					"<div class='carousel-caption d-none d-md-block'>" +
					"<p>" + img.titulo + "</p>" +
					"</div>" +
					"</div>");

				$('.carousel-inner-esp .carousel-item:first').addClass('active');


				console.log(img.titulo);
				console.log(img.imagen);
			});
		});


		$.getJSON("http://metepec.gob.mx/Kioscosdm/api.php?valor=sistemas").done(function (dataSistema) {
			console.log(dataSistema);
			var i = 1;
			var f = 1;
			$.each(dataSistema, function (index, img) {
				$(".enter-items").append("<div class='col-3 col-five'>" +
					"<a class='fireGroup' id='btn-" + i + "' href='#' data-toggle='modal' data-target='#modal" + f + "' data-url='" + img.ruta + "' >" +
					"<img src='" + img.imagen + "' class='img-fluid section'>" +
					"<h5 class='text-center pt-4'>" + img.titulo + "</h5>" +
					"</a>" +
					"</div>");
				i++;
				f++;
				console.log(img.titulo);
				console.log(img.imagen);
				console.log(img.ruta);
				console.log(img.contenido);
			});
		});


		$.getJSON("http://metepec.gob.mx/Kioscosdm/api.php?valor=sistemas").done(function (dataSistemaModal) {
			console.log(dataSistemaModal);
			var t = 1;
			
			$.each(dataSistemaModal, function (index, img) {
				$(".modal-items-circulo").append("<div class='modal fade modal-black' id='modal" + t + "' tabindex='-1' role='dialog' aria-labelledby='exampleModalLabel' > " +
					"<div class='modal-dialog modal-dialog-centered' role='document'>" +
					"<div class='modal-content'>" +
					"<div class='modal-header'>" +
					"<h5 class='modal-title' id='exampleModalLabel'>" + img.titulo + "</h5>" +
					"</div>" +
					"<div class='modal-body'>" +
					"<img src='" + img.imagen + "' class='img-fluid imagen-modal mx-auto d-block'>" +
					"<h3 class='text-center'>Tramite de " + img.titulo + " en proceso, gracias por utilizar el servicio de Kiosco Metepec</h3>" +
					"</div>" +
					"<div class='modal-footer'>" +
					"<img src='../img/logos_metepec.png' class='img-fluid mx-auto d-block' style='max-height: 40px;'>" +
					"</div>" +
					"</div>" +
					"</div>" +
					"</div>");
				t++;
				
				console.log(img.titulo);
				console.log(img.imagen);
				console.log(img.ruta);
				console.log(img.contenido);
			});
		});

	</script>



	<script src="../js/socket.io.js"></script>
	<script>
		$(document).ready(function () {
			setTimeout(function () {
				var socket = io('/kiosco7');
				console.log("EEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEENTRA EL S00000000000000000000000000000OCKET");
				// listen to server events related to messages coming from other users. Call this event "newClick"
				socket.on('newClick', function (msg) {



					$(".modal-black").modal('hide');
					$('.modalAnimacion').modal('hide');
					$('.modalesp').modal('hide');
					$('#modal-anim').removeClass("modalAnimacion");
					$('#modalAnimacionSli').removeClass("modalesp");
					$(msg).modal('show');

					setTimeout(function () {
						$(msg).modal('hide');
						$(".modal-black").modal('hide');
						$('.modalAnimacion').modal('hide');
						$('.modalesp').modal('hide');
						$('#modal-anim').addClass("modalAnimacion");
						$('#modalAnimacionSli').addClass("modalesp");
					}, 120000);
					console.log("got new clickdddd: " + msg);
				});

				// cuando se le da click a cada circulo del menu
				$('.fireGroup').on('click', function () {
					var linkClicked = $(this).attr('data-target');
					console.log(" CLICK EN BOTON CIRCULO")
					/* var iframeUrl = $(this).attr('data-url');
	
					window.open(iframeUrl, '_self');
	 */

					$(".iframe-btn").toggle();
					$(".iframe-content").show();
					$(".main-tramites").hide();

					$(".iframe-btn").click(function () {
						$(".iframe-btn").hide();
						$(".iframe-content").hide();
						$(".main-tramites").show();
						console.log("se esocndio modal negra fondo")
					});

					var iframeUrl = $(this).attr('data-url');
					$('#iframeContainer').attr('src', iframeUrl);
					setInterval(function () {
						window.clearTimeout(timeoutID);
					}, 1000);
					console.log(iframeUrl);

					console.log(linkClicked);
					// emit from client to server
					socket.emit('linkClicked', linkClicked);
					return false;
				});
			}, 2000);
		});

		var timeoutID;
		var clearr;
		var a;
		var b;
		var c;
		var d;
		var e;
		var f;
		var g;
		var h;
		var i;
		var j;

		function setup() {
			this.addEventListener("mousemove", resetTimer, false);
			this.addEventListener("mousedown", resetTimer, false);
			this.addEventListener("keypress", resetTimer, false);
			this.addEventListener("DOMMouseScroll", resetTimer, false);
			this.addEventListener("mousewheel", resetTimer, false);
			this.addEventListener("touchmove", resetTimer, false);
			this.addEventListener("MSPointerMove", resetTimer, false);

			startTimer()
		}

		setup()

		function startTimer() {
			// wait 2 seconds before calling goInactive
			timeoutID = window.setTimeout(goInactive, 60000);
		}

		function resetTimer(e) {
			window.clearTimeout(timeoutID);

			goActive();
		}

		function goInactive() {
			if (navigator.userAgent.search("Firefox") >= 0) {
				console.log("siiii, es FireFox");
				window.clearTimeout(clearr);
				window.clearTimeout(a);
				window.clearTimeout(b);
				window.clearTimeout(c);
				window.clearTimeout(d);
				window.clearTimeout(e);
				window.clearTimeout(f);
				window.clearTimeout(g);
				window.clearTimeout(h);
				window.clearTimeout(i);
				window.clearTimeout(j);


				console.log("estado inactivo zzzzzzzzz")

				var one = "../img/predio.svg"
				var two = "../img/agua.svg"
				var three = "../img/tramitesMunicipales.svg"
				var four = "../img/sare.svg"
				var five = "../img/atencionCiudadana.svg"
				var six = "../img/citasenLinea.svg"
				var seven = "../img/solicituddeEmpleo.svg"
				var eight = "../img/transparencia.svg"
				var nine = "../img/curp.svg"
				var ten = "../img/acta.svg"


				function cero() {

					document.getElementById('dinamic-title').innerHTML = '';
					$('.modalAnimacion').modal('hide');
				}
				function ceroSlider() {

					document.getElementById('dinamic-title').innerHTML = '';
					$('.modalesp').modal('hide');
				}

				function first() {
					$('.modalAnimacion').modal('show')
					$('#modalAnimacion-img').attr('src', one);
					$("#dinamic-title").append("Pago Predial");
				}

				function second() {
					$('.modalesp').modal('show')

				}

				function third() {
					$('.modalAnimacion').modal('show')
					$('#modalAnimacion-img').attr('src', three);
					$("#dinamic-title").append("Pago de Trámites Municipales");
				}

				function fourth() {
					$('.modalAnimacion').modal('show')
					$('#modalAnimacion-img').attr('src', four);
					$("#dinamic-title").append("SARE");
				}

				function fifth() {
					$('.modalAnimacion').modal('show')
					$('#modalAnimacion-img').attr('src', five);
					$("#dinamic-title").append("Atención Ciudadana");
				}

				function sixth() {
					$('.modalAnimacion').modal('show')
					$('#modalAnimacion-img').attr('src', six);
					$("#dinamic-title").append("Citas en Línea para Trámites");
				}

				function seventh() {
					$('.modalAnimacion').modal('show')
					$('#modalAnimacion-img').attr('src', seven);
					$("#dinamic-title").append("Solicitud de Empleo");
				}



				function nineth() {
					$('.modalAnimacion').modal('show')
					$('#modalAnimacion-img').attr('src', nine);
					$("#dinamic-title").append("Obtener CURP");
				}

				function tenth() {
					$('.modalAnimacion').modal('show')
					$('#modalAnimacion-img').attr('src', ten);
					$("#dinamic-title").append("Obtener Acta de Nacimiento");
				}

				cero();
				first();

				clearr = setTimeout(function () {
					cero();
				}, 30000);

				a = setTimeout(function () {
					second();
				}, 60000);

				clearr = setTimeout(function () {
					ceroSlider();
				}, 90000);

				b = setTimeout(function () {
					third();
				}, 120000);

				clearr = setTimeout(function () {
					cero();
				}, 150000);

				c = setTimeout(function () {
					fourth();
				}, 180000);

				clearr = setTimeout(function () {
					cero();
				}, 210000);

				d = setTimeout(function () {
					fifth();
				}, 240000);

				clearr = setTimeout(function () {
					cero();
				}, 270000);

				e = setTimeout(function () {
					sixth();
				}, 300000);

				clearr = setTimeout(function () {
					cero();
				}, 330000);

				f = setTimeout(function () {
					seventh();
				}, 360000);

				clearr = setTimeout(function () {
					cero();
				}, 390000);

				h = setTimeout(function () {
					nineth();
				}, 420000);

				clearr = setTimeout(function () {
					cero();
				}, 450000);

				i = setTimeout(function () {
					tenth();
				}, 480000);

				clearr = setTimeout(function () {
					cero();
				}, 510000);

				setTimeout(function () {
					limpiarTodo()
					setup()
				}, 540000);

				/* 	$('#modalAnimacion').modal('show')
					$('#modalAnimacion-img').attr('src', one);
		
					setTimeout(function () {
						$('#modalAnimacion').modal('hide')
					}, 5000);
		
		
		 */

				$('.modalAnimacion').on('show.bs.modal', function (e) {
					$('#modalAnimacion-img').addClass('animated flipInY');
				})
				$('.modalAnimacion').on('shown.bs.modal', function (e) {
					$('.modal-backdrop').addClass('modal-backdrop-white');
				})
			} else {
				console.log("Nop, no FireFox");
			}
		}

		function limpiarTodo() {
			window.clearTimeout(clearr);
			window.clearTimeout(a);
			window.clearTimeout(b);
			window.clearTimeout(c);
			window.clearTimeout(d);
			window.clearTimeout(e);
			window.clearTimeout(f);
			window.clearTimeout(g);
			window.clearTimeout(h);
			window.clearTimeout(i);
			window.clearTimeout(j);
			window.clearTimeout(startTimer);
		}

		function goActive() {


			// do something

			$('.modalesp').modal('hide');
			$('.modalAnimacion').modal('hide');

			console.log("estado activooo")

		}

	</script>




</body>

</html>